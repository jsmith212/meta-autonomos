##########
# HEADER #
##########
header:
  version: 20
  includes:
    - includes/base.yaml
    - includes/raspberrypi-5.yaml
    # - includes/shared-state.yaml # Include this if you have a shared state cahche server configured
    - secrets.yaml

##########
# TARGET #
##########
build_system: oe
distro: autonomos
target: autonomos-devel

#######################
# BUILD CONFIGURATION #
#######################
bblayers_conf_header:
  meta-custom: |
    POKY_BBLAYERS_CONF_VERSION = "2"
    BBPATH = "${TOPDIR}"
    BBFILES ?= ""

local_conf_header:
  standard: |
    PATCHRESOLVE = "noop"
    CONF_VERSION = "2"
    IMAGE_FSTYPES = "tar"
    USER_CLASSES ?= "buildstats"
    TMPDIR = "${TOPDIR}/tmp-${MACHINE}"

  autonomos: |
    AUTONOMOS_FEATURES = "shellplus containers kubernetes"

  extras: |
    EXTRA_IMAGE_FEATURES ?= "debug-tweaks"

  diskmonitoring: |
    BB_DISKMON_DIRS ??= "\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    STOPTASKS,/tmp,100M,100K \
    HALT,${TMPDIR},100M,1K \
    HALT,${DL_DIR},100M,1K \
    HALT,${SSTATE_DIR},100M,1K \
    HALT,/tmp,10M,1K"

  parallel: |
    BB_NUMBER_THREADS ?= "${@oe.utils.cpu_count()}"
    PARALLEL_MAKE ?= "-j ${@oe.utils.cpu_count()}"
